
{% for b, filename in blocks_data -%}
<a href="#{{ b.find('reference').text }}">{{ b.find('reference').text|replace('_',' ') }}</a> &nbsp;
{% endfor %}

<br><br><br>

{% for b, filename in blocks_data %}
<a name="{{ b.find('reference').text }}"></a>
<b>{{ b.find('reference').text|replace('_',' ') }}</b>
<table border="1">
    <tr>
        <td>Al Statement:</td><td>{{ b.find('algdata/algorithm_statement').text or '' }}</td>
        <td>Al Math:</td><td>{{ b.find('algdata/algorithm_math').text or '' }}</td>
    </tr>
    <tr>
        <td colspan="4">{%- if b.find('algdata/variables') %}
            <table class="algo">
                <tr>
                    {%- for var in b.find('algdata/variables') %}
                    <td>{% if var.find('description').text %}{{ var.find('description').text }} in {% endif %}<a href="../units/{{var.find('unit').text}}.html">{{ var.find('unit').text or '' }}</a></td>
                    {%- endfor %}
                </tr>
                <tr>
                    {%- for var in b.find('algdata/variables') %}
                    <td><input type="text" name="{{var.tag}}" oninput="calc()" onkeyup="calc()"{% if var.find('op').text %} op="{{var.find('op').text}}"{% endif %}></td>
                    {%- endfor %}
                </tr>
                {%- if b.find('algdata/results') %}
                <tr>
                    {%- for var in b.find('algdata/results') %}
                    <td>{% if var.find('description').text %}{{ var.find('description').text }} in {% endif %}<a href="../units/{{var.find('unit').text}}.html">{{ var.find('unit').text or '' }}</a></td>
                    {%- endfor %}
                </tr>
                <tr>
                    {%- for var in b.find('algdata/results') %}
                    <td><input type="text" name="{{var.tag}}" disabled=""{% if var.find('op').text %} oninput="calc()" op="{{var.find('op').text}}"{% endif %}></td>
                    {%- endfor %}
                </tr>
                {%- endif %}
            </table>
        {% endif %}</td>
    </tr>
    <tr>
        <td>Source info:</td><td>{% if b.find('biblioref/abbrev').text %}<a href="../bibliography/bibliography.html#{{(b.find('biblioref/authorgroup/author/surname') or '').text|replace(' ','')|strip('.,')}}{{(b.find('biblioref/authorgroup/author/firstname').text or '')|replace(' ','')|strip('.,')}}">{{ b.find('biblioref/abbrev').text|replace('_',' ') }}</a>{% endif %}
        {%- if b.find('biblioref/pagenums').text %}, {{ b.find('biblioref/pagenums').text }}{% endif %}</td>
        <td>Also cited in:</td><td>{% if b.find('biblioref/abbrev2').text %}<a href="../bibliography/bibliography.html#{{(b.find('biblioref/authorgroup/author2/surname') or '').text|replace(' ','')|strip('.,')}}{{(b.find('biblioref/authorgroup/author2/firstname').text or '')|replace(' ','')|strip('.,')}}">{{ b.find('biblioref/abbrev2').text|replace('_',' ') }}</a>{% endif %}
    </tr>
    <tr>
        <td>Algorithm type:</td><td>{% if b.find('algorithm_description/algorithm_type').text %}<a href="../algorithm_type/{{b.find('algorithm_description/algorithm_type').text|replace(' ','_')|lower}}.html">{{ b.find('algorithm_description/algorithm_type').text }}</a>{% endif %}</td>
        <td>Position in process:</td><td>{% if b.find('algorithm_description/position_in_process').text %}<a href="../position_in_process/{{b.find('algorithm_description/position_in_process').text|replace(' ','_')|lower}}.html">{{ b.find('algorithm_description/position_in_process').text }}</a>{% endif %}</td>
    </tr>
    <tr>
        <td>Material:</td><td>{% if b.find('algorithm_description/material').text %}<a href="../material/{{b.find('algorithm_description/material').text|replace(' ','_')|lower}}.html">{{ b.find('algorithm_description/material').text }}</a>{% endif %}</td>
        <td>Source type:</td><td>{% if b.find('algorithm_description/source_type').text %}<a href="../source_type/{{b.find('algorithm_description/source_type').text|replace(' ','_')|lower}}.html">{{ b.find('algorithm_description/source_type').text }}</a>{% endif %}</td>
    </tr>
    <tr>
        <td>Source chronology:</td><td>{% if b.find('algorithm_description/source_chronology').text %}<a href="../source_chronology/{{b.find('algorithm_description/source_chronology').text|replace(' ','_')|lower}}.html">{{ b.find('algorithm_description/source_chronology').text }}</a>{% endif %}</td>
        <td>Source geography:</td><td>{% if b.find('algorithm_description/source_geography').text %}<a href="../source_geography/{{b.find('algorithm_description/source_geography').text|replace(' ','_')|lower}}.html">{{ b.find('algorithm_description/source_geography').text }}</a>{% endif %}</td>
    </tr>
    <tr>
        <td>Notes:</td><td colspan="3">{{ b.find('algnotes/general_notes').text or '' }}</td>
    </tr>
    <tr>
        <td>Notes on bibliography:</td><td colspan="3">{{ b.find('algnotes/biblio_notes').text or '' }}</td>
    </tr>
    <tr>
        <td>How to cite:</td><td>EnCAB alg. - {{ b.find('reference').text }}</td>
        <td>Created by/on:</td><td>{% if b.find('algauthors/creation_author_group/author') %}<a href="../bibliography/bibliography.html#{{(b.find('algauthors/creation_author_group/author/surname') or '').text|replace(' ','')|strip('.,')}}{{(b.find('algauthors/creation_author_group/author/firstname').text or '')|replace(' ','')|strip('.,')}}">{{(b.find('algauthors/creation_author_group/author/surname') or '').text}} {{(b.find('algauthors/creation_author_group/author/firstname').text or '')}}</a>{% endif %}
        {%- if b.find('algauthors/creation_author_group/creation_date').text %}, {{ b.find('algauthors/creation_author_group/creation_date').text }}{% endif %}</td>
    </tr>
    <tr>
        <td>Input data:</td><td><a href="../algorithms_data/{{filename}}">{{ filename }}</a></td>
        <td>Modified by/on:</td><td>
        {%- for modification_author_group in b.find('algauthors/modification_author_group') %}
            <a href="../bibliography/bibliography.html#{{(modification_author_group.find('author/surname') or '').text|replace(' ','')|strip('.,')}}{{(modification_author_group.find('author/firstname').text or '')|replace(' ','')|strip('.,')}}">{{(modification_author_group.find('author/surname') or '').text}} {{(modification_author_group.find('author/firstname').text or '')}}</a>
            {%- if modification_author_group.find('creation_date').text %}, {{ modification_author_group.find('creation_date').text }}{% endif %}
        {%- if not loop.last %}; {% endif %}{% endfor %}</td>
    </tr>
</table>
<br><br>

{% endfor %}
